<odoo>
  <data>
    <!-- explicit list view definition -->
<!--
    <record model="ir.ui.view" id="wgd_field_service.list">
      <field name="name">wgd_field_service list</field>
      <field name="model">wgd_field_service.wgd_field_service</field>
      <field name="arch" type="xml">
        <tree>
          <field name="name"/>
          <field name="value"/>
          <field name="value2"/>
        </tree>
      </field>
    </record>
-->

    <!-- actions opening views on models -->
<!--
    <record model="ir.actions.act_window" id="wgd_field_service.action_window">
      <field name="name">wgd_field_service window</field>
      <field name="res_model">wgd_field_service.wgd_field_service</field>
      <field name="view_mode">tree,form</field>
    </record>
-->

    <!-- server action to the one above -->
<!--
    <record model="ir.actions.server" id="wgd_field_service.action_server">
      <field name="name">wgd_field_service server</field>
      <field name="model_id" ref="model_wgd_field_service_wgd_field_service"/>
      <field name="state">code</field>
      <field name="code">
        action = {
          "type": "ir.actions.act_window",
          "view_mode": "tree,form",
          "res_model": model._name,
        }
      </field>
    </record>
-->

    <!-- Top menu item -->
<!--
    <menuitem name="wgd_field_service" id="wgd_field_service.menu_root"/>
-->
    <!-- menu categories -->
<!--
    <menuitem name="Menu 1" id="wgd_field_service.menu_1" parent="wgd_field_service.menu_root"/>
    <menuitem name="Menu 2" id="wgd_field_service.menu_2" parent="wgd_field_service.menu_root"/>
-->
    <!-- actions -->
<!--
    <menuitem name="List" id="wgd_field_service.menu_1_list" parent="wgd_field_service.menu_1"
              action="wgd_field_service.action_window"/>
    <menuitem name="Server to list" id="wgd_field_service" parent="wgd_field_service.menu_2"
              action="wgd_field_service.action_server"/>
-->
       <record id="industry_fsm.fsm_tasks_menu" model="ir.ui.menu">
            <field name="name">My Workorders</field>
        </record>
       <!--  <record id="industry_fsm.project_task_action_fsm" model="ir.ui.view">
            <field name="name">My Workorders</field>
        </record> -->
        <record model="ir.actions.act_window" id="industry_fsm.project_task_action_fsm">
            <field name='name'>My Workorders</field>
        </record>
        <record id="industry_fsm.fsm_menu_tasks_kanban" model="ir.ui.menu">
            <field name="name">Workorders</field>
        </record>
        <record id="industry_fsm.fsm_menu_all_tasks_root" model="ir.ui.menu">
            <field name="name">All Workorders</field>
        </record>
        <record id="industry_fsm.project_task_action_all_fsm" model="ir.actions.act_window">
            <field name="name">All Workorders</field>
        </record>
        <record id="industry_fsm.fsm_menu_all_tasks_todo" model="ir.ui.menu">
            <field name="name">All Workorders</field>
        </record>

      <record id="inherited_field_service_form" model="ir.ui.view">
          <field name="name">inherit_field_service_form</field>
          <field name="model">project.task</field>
          <field name="inherit_id" ref="project.view_task_form2" />
          <field name="type">form</field>
          <field name="arch" type="xml">
            <xpath expr="//notebook" position="inside">
              <page name="trips_tolls" string="Trips/Tolls">
                <div>
                    <div style="padding:2% !important;border:solid #e6e5e5 0.1px;margin-left:0.5%;">
                        <field name="trips_tolls">
                          <tree editable="bottom">
                              <field name="sku" string="SKU" domain="[('company_id', '=', parent.company_id)]"/>
                              <field name="date" string="Date"/>
                              <field name="description"/>
                              <field name="trips_tolls" string="Trips/Tolls"/>
                              <field name="qty" string="Quantity" sum="Total Quantity"/>
                              <field name="unit_price" string="Unit Price"/>
                              <field name="ext_price" string="Ext.Price" sum="Total Price"/>
                          </tree>
                        </field>
                    </div>
                </div>
              </page>
            </xpath>

            <!-- <xpath expr="//header" position="inside">
                <field name="display_create_invoice_primary" invisible="1"/>    
                <button name="create_estimate" string="Create Estimate" type="object" class="oe_highlight"/>
            </xpath> -->

           
          </field>
        </record>

        <template id="report_invoice_document" inherit_id="account.report_invoice_document">
        <xpath expr="//div[hasclass('page')]" position="replace">
        <div class="page">

            <h2>
                <span t-if="o.move_type == 'out_invoice' and o.state == 'posted'">Invoice</span>
                <span t-if="o.move_type == 'out_invoice' and o.state == 'draft'">Draft Invoice</span>
                <span t-if="o.move_type == 'out_invoice' and o.state == 'cancel'">Cancelled Invoice</span>
                <span t-if="o.move_type == 'out_refund'">Credit Note</span>
                <span t-if="o.move_type == 'in_refund'">Vendor Credit Note</span>
                <span t-if="o.move_type == 'in_invoice'">Vendor Bill</span>
                <span t-if="o.name != '/'" t-field="o.name"/>
            </h2>
            <div id="informations" class="row mt32 mb32">
                <div class="col-auto col-3 mw-100 mb-2" name="due_date">
                    <strong>Cust NO:</strong>
                    <p class="m-0" t-field="o.partner_id.customer_id"/>
                    <!-- <p class="m-0" t-field="o.timesheet_ids.order_id.partner_id"/> -->
                </div>
                <div class="col-auto col-3 mw-100 mb-2" name="due_date">
                    <strong>JOB NO:</strong>
                    <p class="m-0" t-field="o.job_ord_no"/>
                </div>
                <!-- <div class="col-auto col-3 mw-100 mb-2" name="due_date">
                    <strong>Purchase Order:</strong>
                    <p class="m-0" t-field="o.timesheet_ids.order_id.po_no"/>
                </div> -->
                <!-- <div class="col-auto col-3 mw-100 mb-2" name="due_date">
                    <strong>Reference:</strong>
                    <p class="m-0" t-field="o.timesheet_ids.order_id.reference"/>
                </div> -->
                <div class="col-auto col-3 mw-100 mb-2" name="due_date">
                    <strong>Terms:</strong>
                    <p class="m-0" t-field="o.payment_term_id"/>
                </div>
                <div class="col-auto col-3 mw-100 mb-2" name="due_date">
                    <strong>Clerk:</strong>
                    <p class="m-0" t-field="o.clerk"/>
                </div>
            </div><br/>
            <div id="informations" class="row mt32 mb32">
                <!-- <div class="col-auto col-3 mw-100 mb-2" name="due_date">
                    <strong>Terminal:</strong>
                    <p class="m-0" t-field="o.timesheet_ids.order_id.terminal"/>
                </div> -->
                <!-- <div class="col-auto col-3 mw-100 mb-2" name="due_date">
                    <strong>Order:</strong>
                    <p class="m-0" t-field="o.timesheet_ids.order_id.w_order"/>
                </div> -->
                <div class="col-auto col-3 mw-100 mb-2" t-if="o.invoice_date" name="invoice_date">
                    <strong>Invoice Date:</strong>
                    <p class="m-0" t-field="o.invoice_date"/>
                </div>
                <div class="col-auto col-3 mw-100 mb-2" t-if="o.invoice_date_due and o.move_type == 'out_invoice' and o.state == 'posted'" name="due_date">
                    <strong>Due Date:</strong>
                    <p class="m-0" t-field="o.invoice_date_due"/>
                </div>
                <div class="col-auto col-3 mw-100 mb-2" t-if="o.invoice_origin" name="origin">
                    <strong>Source:</strong>
                    <p class="m-0" t-field="o.invoice_origin"/>
                </div>
                <div class="col-auto col-3 mw-100 mb-2" t-if="o.partner_id.ref" name="customer_code">
                    <strong>Customer Code:</strong>
                    <p class="m-0" t-field="o.partner_id.ref"/>
                </div>
                <div class="col-auto col-3 mw-100 mb-2" t-if="o.ref" name="reference">
                    <strong>Reference:</strong>
                    <p class="m-0" t-field="o.ref"/>
                </div>
            </div>
            <br/><br/>

            <t t-set="display_discount" t-value="any(l.discount for l in o.invoice_line_ids)"/>

           <table class="table table-condensed o_main_table table-sm table-bordered" name="invoice_line_table">
           <thead>
                <th class="text-center">SKU</th>
                <th class="text-center">DESCRIPTION</th>
                <th class="text-center">SHIPPED</th>
                <th>ORDERED</th>
                <th>UM</th>
                <th class="text-center">UNITS</th>
                <th class="text-center">PRICE/ PER</th>
                <th class="text-center">EXTENSION</th>
            </thead>
            <tbody class="invoice_tbody">
                <t t-set="current_subtotal" t-value="0"/>
                <t t-set="lines" t-value="o.invoice_line_ids.sorted(key=lambda l: (-l.sequence, l.date, l.move_name, -l.id), reverse=True)"/>
                <t t-foreach="lines" t-as="line">
                    <tr t-att-class="'bg-200 font-weight-bold o_line_section' if line.display_type == 'line_section' else 'font-italic o_line_note' if line.display_type == 'line_note' else ''">
                        <td t-attf-class="text-right {{ 'd-none d-md-table-cell' if report_type == 'html' else '' }}">
                            <span class="text-nowrap" t-field="line.product_id"/>
                        </td>
                        <td t-attf-class="text-right {{ 'd-none d-md-table-cell' if report_type == 'html' else '' }}">
                            <span class="text-nowrap" t-field="line.product_id.name"/>
                        </td>
                        <td t-attf-class="text-right {{ 'd-none d-md-table-cell' if report_type == 'html' else '' }}">
                            <span class="text-nowrap" t-field="line.quantity"/>
                        </td>
                        <td t-attf-class="text-right {{ 'd-none d-md-table-cell' if report_type == 'html' else '' }}">
                            <span class="text-nowrap" t-field="line.quantity"/>
                        </td>
                        <td t-attf-class="text-right {{ 'd-none d-md-table-cell' if report_type == 'html' else '' }}">
                            <span class="text-nowrap" t-field="line.product_uom_id.name"/>
                        </td>
                        <td t-attf-class="text-right {{ 'd-none d-md-table-cell' if report_type == 'html' else '' }}">
                            <span class="text-nowrap" t-field="line.quantity"/>
                        </td>
                        <td t-attf-class="text-right {{ 'd-none d-md-table-cell' if report_type == 'html' else '' }}">
                            <span class="text-nowrap" t-field="line.price_unit"/> / <span t-esc="line.product_uom_id.name"/>
                        </td>
                        <td t-attf-class="text-right {{ 'd-none d-md-table-cell' if report_type == 'html' else '' }}">
                            <span class="text-nowrap" t-field="line.price_subtotal"/>
                        </td>
                    </tr>

                    <t t-if="current_section and (line_last or lines[line_index+1].display_type == 'line_section')">
                        <tr class="is-subtotal text-right">
                            <td colspan="99">
                                <strong class="mr16">Subtotal</strong>
                                <span
                                    t-esc="current_subtotal"
                                    t-options='{"widget": "monetary", "display_currency": o.currency_id}'
                                />
                            </td>
                        </tr>
                    </t>

                </t>
            </tbody>
          </table>
        <div class="clearfix">
            <div id="total" class="row">
                <div t-attf-class="#{'col-6' if report_type != 'html' else 'col-sm-7 col-md-6'} ml-auto">
                    <table class="table table-sm" style="page-break-inside: avoid;">

                        <!--Tax totals-->
                        <t t-set="tax_totals" t-value="json.loads(o.tax_totals_json)"/>
                        <t t-call="account.document_tax_totals"/>

                        <!--Payments-->
                        <t t-if="print_with_payments">
                            <t t-if="o.payment_state != 'invoicing_legacy'">
                                <t t-set="payments_vals" t-value="o.sudo()._get_reconciled_info_JSON_values()"/>
                                <t t-foreach="payments_vals" t-as="payment_vals">
                                    <tr>
                                        <td>
                                            <i class="oe_form_field text-right oe_payment_label">Paid on <t t-esc="payment_vals['date']" t-options='{"widget": "date"}'/></i>
                                        </td>
                                        <td class="text-right">
                                            <span t-esc="payment_vals['amount']" t-options='{"widget": "monetary", "display_currency": o.currency_id}'/>
                                        </td>
                                    </tr>
                                </t>
                                <t t-if="len(payments_vals) > 0">
                                    <tr class="border-black">
                                        <td><strong>Amount Due</strong></td>
                                        <td class="text-right">
                                            <span t-field="o.amount_residual"/>
                                        </td>
                                    </tr>
                                </t>
                            </t>
                        </t>
                    </table>
                </div>
            </div>
        </div>

        </div>
        </xpath>
            <xpath expr="//t[@t-set='address']" position="replace">
                <!-- <div class="pt-5"> -->
       
                    <div class="address row">
                        <div style="border:solid 1px black;padding:2%;width:47%;margin-right:2%; margin-left:2%;">
                            <b><t t-esc="o.company_id.name"/></b><br/>
                            <t t-esc="o.company_id.street"/><br/>
                            <t t-esc="o.company_id.street2"/><br/>
                            <t t-esc="o.company_id.city"/> <t t-esc="o.company_id.state_id.name"/>
                            <t t-esc="o.company_id.zip"/><br/>
                            <t t-esc="o.company_id.country_id.name"/>
                        </div>
                        <div name="address" style="width:47%;">
                            <address style="border:solid 1px black;padding:5%;height:100%;"><address class="mb-0" itemscope="itemscope" itemtype="http://schema.org/Organization">
                            <div>
                                <span itemprop="name"><t t-esc="o.partner_id.name"/></span>
                            </div>
                            <div itemprop="address" itemscope="itemscope" itemtype="http://schema.org/PostalAddress">
                                <div class="d-flex align-items-baseline">
                                    <span class="w-100 o_force_ltr d-block" itemprop="streetAddress"><t t-esc="o.partner_id.street"/><br/><t t-esc="o.partner_id.street2"/><br/><t t-esc="o.partner_id.city"/> <t t-esc="o.partner_id.state_id.name"/> <t t-esc="o.partner_id.zip"/><br/><t t-esc="o.partner_id.country_id.name"/></span>
                                </div>
                            </div>
                            </address></address>
                        </div>
                    </div>
                <!-- </div> -->
                    <div>
                        <div style="border:solid 1px #dee2e6;padding:2%;margin-top:5%;width:45%;" class="ml-auto">
                            <b>Summary of Work :</b><span t-esc="o.partner_id.comment" style="margin-bottom:0.5rem !important;"/>
                            <!-- <b>Summary of Work :</b><span t-esc="o.timesheet_ids.task_id.description" style="margin-bottom:0.5rem !important;"/> -->
                        </div>
                    </div>
                <div t-if="o.partner_id.vat" class="mt16">
                        <t t-if="o.company_id.account_fiscal_country_id.vat_label" t-esc="o.company_id.account_fiscal_country_id.vat_label" id="inv_tax_id_label"/>
                        <t t-else="">Tax ID</t>: <span t-field="o.partner_id.vat"/></div>
            </xpath>

         <!-- <xpath expr="//t[@t-set='address']/address" position="after">
            <div style="border:solid 1px #dee2e6;padding:5%;">
                <b>Summary of Work :</b> <span t-esc="o.timesheet_ids.task_id.description" style="margin-bottom:0.5rem !important;"/>
            </div>
         </xpath> -->
         <!-- <xpath expr="//t[@t-set='address']/address" position="attributes">
            <attribute name="t-attf-style">border:solid 1px #dee2e6;padding:5%;</attribute>
         </xpath> -->
         <!-- <xpath expr="//t[@t-set='address']" position="before">
            <div style="border:solid 1px #dee2e6;padding:5%;width:50%;">
                <b><t t-esc="o.company_id.name"/></b><br/>
                <t t-esc="o.company_id.street"/><br/>
                <t t-esc="o.company_id.street2"/><br/>
                <t t-esc="o.company_id.city"/> <t t-esc="o.company_id.state_id.name"/> 
                <t t-esc="o.company_id.zip"/><br/>
                <t t-esc="o.company_id.country_id.name"/>
            </div>
         </xpath> -->

        </template>

    <!-- <record id="sale_order_line_inherit" model="ir.ui.view">
        <field name="name">sale.order.line.inherit</field>
        <field name="model">sale.order.line</field>
        <field name="inherit_id" ref="sale.view_order_line_tree"/>
        <field name="arch" type="xml">
            <xpath expr="//tree" position="replace">
                <tree></tree>
            </xpath>
        </field>
    </record> -->

    <template id="line_template_inherit" inherit_id="account_reports.line_template">
        <xpath expr="//span[hasclass('account_report_line_name')]//span" position="before">
            <t t-esc="line.get('customer_id')"/>
        </xpath>
    </template>

    <template id="main_table_header_inherit" inherit_id="account_reports.main_table_header">
        <xpath expr="//tr" position="replace">
            <tr>
                <t t-foreach="header_line" t-as="cell">
                <t t-if="cell.get('pl_report') != True">
                    <th t-att-class="'o_account_report_column_header ' + (cell.get('class', ''))"
                        t-att-colspan="cell.get('colspan')"
                        t-att-style="cell.get('style', '')"
                        t-att-title="cell.get('title')"
                        t-att-data-toggle="cell.get('data-toggle')">
                        <t t-call="{{cell.get('template', 'account_reports.cell_template')}}"/>
                    </th>
                </t>
                </t>
            </tr>
        </xpath>
    </template>
    
    <record id="view_order_form_inherit_fieldservice" model="ir.ui.view">
        <field name="name">sale.order.form.inherit.field.service</field>
        <field name="model">sale.order</field>
        <field name="inherit_id" ref="sale.view_order_form"/>
        <field name="arch" type="xml">
            <xpath expr="//field[@name='payment_term_id']" position="after">
                <field name="job_ord_no" string="Job No"/>
                <field name="clerk"/>
            </xpath>
            <xpath expr="//field[@name='sale_order_template_id']" position="after">
                <field name="w_tax" string="Tax"/>
            </xpath>
             <xpath expr="//field[@name='partner_id']" position="attributes">
                <attribute name="domain">[('customer_rank', '>=', 1)]</attribute>
            </xpath>
            <xpath expr="//group" position="after">
                 <div class="row" col="2" style="width:100%;">
                    <div class="row" col="2" style="width:50%">
                        <div style="width:31%;margin-left:3%;">
                            <label for="ship_to" string="Ship To" style="width:37%;padding-left:10%;"/>
                        </div>
                        <div class="o_address_format" style="width:55%">
                            <field name="ship_to" placeholder="Address" class="o_address_street"/>
                            <field name="ship_to_street" placeholder="Address" class="o_address_street" />
                            <field name="ship_to_city" placeholder="City" class="o_address_city" style="width:30%;" />
                            <field name="ship_to_state" class="o_address_state" placeholder="State" style="width:30%;"/>
                            <field name="zip_code" placeholder="ZIP" class="o_address_zip" style="width:30%;"/>
                            <field  name="ship_to_country" style="width:40%;" placeholder="Country"/>
                            <field name="country_id" invisible="1"/>
                        </div>
                    </div>
                        <div style="width:51.5%"></div>
                </div>
            </xpath>
            <xpath expr="//tree/field[@name='product_id']" position="replace">
                <field name="product_id" string="SKU"/>
            </xpath>
            <xpath expr="//field[@name='order_line']//tree/field[@name='name']" position="after">
                 <field name="product_id" context="{'form_view_ref': 'wg_inventory.product_new','tree_view_ref': 'wg_inventory.product_template_tree_view'}" invisible="1"  />
            </xpath>
            <xpath expr="//tree/field[@name='name']" position="replace">
                <field name="name" invisible="1"/>
                <field name="description"/>
                <field name="avg_cost"/>
            </xpath>
            <xpath expr="//tree/field[@name='tax_id']" position="attributes">
               <attribute name="domain">[('type_tax_use','=','sale'),('country_id', '=', parent.tax_country_id)]</attribute>
             </xpath>
        </field>
    </record>

    <record id="view_invoice_form_inherit_customer_invoice" model="ir.ui.view">
        <field name="name">account.move.form.inherit.customer.invoice</field>
        <field name="model">account.move</field>
        <field name="inherit_id" ref="account.view_move_form"/>
        <field name="arch" type="xml">
            <xpath expr="//field[@name='payment_reference']" position="after">
                <field name="job_ord_no" string="Job No"/>
                <field name="clerk"/>
                <field name="w_tax" string="Tax"/>
                <field name="payment_term_id" string="Payment Terms"/>
            </xpath> 
            <xpath expr="//group" position="after">
                 <div class="row" col="2" style="width:100%;">
                    <div class="row" col="2" style="width:50%">
                        <div style="width:31%;margin-left:3%;">
                            <label for="ship_to" string="Ship To" style="width:37%;padding-left:10%;"/>
                        </div>
                        <div class="o_address_format" style="width:55%">
                            <field name="ship_to" placeholder="Address" class="o_address_street"/>
                            <field name="ship_to_street" placeholder="Address" class="o_address_street" />
                            <field name="ship_to_city" placeholder="City" class="o_address_city" style="width:30%;" />
                            <field name="ship_to_state" class="o_address_state" placeholder="State" style="width:30%;"/>
                            <field name="zip_code" placeholder="ZIP" class="o_address_zip" style="width:30%;"/>
                            <field  name="ship_to_country" style="width:40%;" placeholder="Country"/>
                            <field name="country_id" invisible="1"/>
                        </div>
                    </div>
                        <div style="width:51.5%"></div>
                </div>
            </xpath>
        </field>
    </record>

    <record id="action_sales" model="ir.actions.act_window">
        <field name="name">Sale Order FieldService</field>
        <field name="res_model">sale.order</field>
        <field name="view_mode">tree,form,kanban</field>
        <!-- <field name="view_ids" eval="[(5, 0, 0),(0, 0, {'view_mode': 'form', 'view_id': ref('view_order_form_inherit_fieldservice')})]"/> -->
    </record>
    <menuitem
        id="create_estimate_menu"
        name="Create Estimate"
        action="action_sales"
        parent="industry_fsm.fsm_tasks_menu"
        sequence="30"/>

  </data>
</odoo>